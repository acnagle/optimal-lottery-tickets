Namespace(batch_size=64, bias=None, data='../data', device=0, epochs=20, hidden_size=500, load_weights='./paper/lenet5/lenet5_e50_h500.pt', log_interval=100, lr=0.01, model='redlenet5', momentum=0.9, no_cuda=False, r=5, save_model=None, save_results=True, seed=1, sparsity=0.02, use_relu=False, wd=0.0005) 

Training a RedLeNet5 network ...
Train Epoch: 1 [6336/60000 (11%)]	Loss: 1.589047
Train Epoch: 1 [12736/60000 (21%)]	Loss: 1.203286
Train Epoch: 1 [19136/60000 (32%)]	Loss: 0.767450
Train Epoch: 1 [25536/60000 (43%)]	Loss: 0.981925
Train Epoch: 1 [31936/60000 (53%)]	Loss: 1.849517
Train Epoch: 1 [38336/60000 (64%)]	Loss: 1.697098
Train Epoch: 1 [44736/60000 (75%)]	Loss: 1.336214
Train Epoch: 1 [51136/60000 (85%)]	Loss: 1.568365
Train Epoch: 1 [57536/60000 (96%)]	Loss: 1.212293

Test set: Average loss: 1.8664, Accuracy: 5650/10000 (56%)

Train Epoch: 2 [6336/60000 (11%)]	Loss: 2.275721
Train Epoch: 2 [12736/60000 (21%)]	Loss: 1.352383
Train Epoch: 2 [19136/60000 (32%)]	Loss: 3.317415
Train Epoch: 2 [25536/60000 (43%)]	Loss: 2.452473
Train Epoch: 2 [31936/60000 (53%)]	Loss: 2.771584
Train Epoch: 2 [38336/60000 (64%)]	Loss: 3.610422
Train Epoch: 2 [44736/60000 (75%)]	Loss: 3.953056
Train Epoch: 2 [51136/60000 (85%)]	Loss: 4.363613
Train Epoch: 2 [57536/60000 (96%)]	Loss: 3.203595

Test set: Average loss: 4.2053, Accuracy: 4276/10000 (43%)

Train Epoch: 3 [6336/60000 (11%)]	Loss: 4.062041
Train Epoch: 3 [12736/60000 (21%)]	Loss: 4.001492
Train Epoch: 3 [19136/60000 (32%)]	Loss: 3.838670
Train Epoch: 3 [25536/60000 (43%)]	Loss: 4.736621
Train Epoch: 3 [31936/60000 (53%)]	Loss: 5.459845
Train Epoch: 3 [38336/60000 (64%)]	Loss: 3.997370
Train Epoch: 3 [44736/60000 (75%)]	Loss: 4.733524
Train Epoch: 3 [51136/60000 (85%)]	Loss: 4.490445
Train Epoch: 3 [57536/60000 (96%)]	Loss: 4.709735

Test set: Average loss: 5.3770, Accuracy: 2629/10000 (26%)

Train Epoch: 4 [6336/60000 (11%)]	Loss: 5.884360
Train Epoch: 4 [12736/60000 (21%)]	Loss: 6.379871
Train Epoch: 4 [19136/60000 (32%)]	Loss: 6.319195
Train Epoch: 4 [25536/60000 (43%)]	Loss: 4.620781
Train Epoch: 4 [31936/60000 (53%)]	Loss: 5.712595
Train Epoch: 4 [38336/60000 (64%)]	Loss: 6.041486
Train Epoch: 4 [44736/60000 (75%)]	Loss: 7.061063
Train Epoch: 4 [51136/60000 (85%)]	Loss: 5.360969
Train Epoch: 4 [57536/60000 (96%)]	Loss: 7.396956

Test set: Average loss: 6.2890, Accuracy: 2456/10000 (25%)

Train Epoch: 5 [6336/60000 (11%)]	Loss: 5.928530
Train Epoch: 5 [12736/60000 (21%)]	Loss: 6.069504
Train Epoch: 5 [19136/60000 (32%)]	Loss: 6.159554
Train Epoch: 5 [25536/60000 (43%)]	Loss: 7.349526
Train Epoch: 5 [31936/60000 (53%)]	Loss: 7.311238
Train Epoch: 5 [38336/60000 (64%)]	Loss: 7.474053
Train Epoch: 5 [44736/60000 (75%)]	Loss: 7.460861
Train Epoch: 5 [51136/60000 (85%)]	Loss: 7.108634
Train Epoch: 5 [57536/60000 (96%)]	Loss: 7.457037

Test set: Average loss: 8.0222, Accuracy: 2089/10000 (21%)

Train Epoch: 6 [6336/60000 (11%)]	Loss: 8.725146
Train Epoch: 6 [12736/60000 (21%)]	Loss: 7.401558
Train Epoch: 6 [19136/60000 (32%)]	Loss: 8.203803
Train Epoch: 6 [25536/60000 (43%)]	Loss: 8.806421
Train Epoch: 6 [31936/60000 (53%)]	Loss: 7.371359
Train Epoch: 6 [38336/60000 (64%)]	Loss: 8.644217
Train Epoch: 6 [44736/60000 (75%)]	Loss: 8.216144
Train Epoch: 6 [51136/60000 (85%)]	Loss: 9.789250
Train Epoch: 6 [57536/60000 (96%)]	Loss: 7.740463

Test set: Average loss: 8.7481, Accuracy: 1752/10000 (18%)

Train Epoch: 7 [6336/60000 (11%)]	Loss: 8.085541
Train Epoch: 7 [12736/60000 (21%)]	Loss: 8.881653
Train Epoch: 7 [19136/60000 (32%)]	Loss: 8.902747
Train Epoch: 7 [25536/60000 (43%)]	Loss: 8.446078
Train Epoch: 7 [31936/60000 (53%)]	Loss: 7.855499
Train Epoch: 7 [38336/60000 (64%)]	Loss: 8.651020
Train Epoch: 7 [44736/60000 (75%)]	Loss: 10.223084
Train Epoch: 7 [51136/60000 (85%)]	Loss: 9.967406
Train Epoch: 7 [57536/60000 (96%)]	Loss: 9.085241

Test set: Average loss: 9.1309, Accuracy: 1492/10000 (15%)

Train Epoch: 8 [6336/60000 (11%)]	Loss: 8.535851
Train Epoch: 8 [12736/60000 (21%)]	Loss: 7.577658
Train Epoch: 8 [19136/60000 (32%)]	Loss: 8.116006
Train Epoch: 8 [25536/60000 (43%)]	Loss: 8.413058
Train Epoch: 8 [31936/60000 (53%)]	Loss: 7.317230
Train Epoch: 8 [38336/60000 (64%)]	Loss: 9.226375
Train Epoch: 8 [44736/60000 (75%)]	Loss: 9.211176
Train Epoch: 8 [51136/60000 (85%)]	Loss: 8.176857
Train Epoch: 8 [57536/60000 (96%)]	Loss: 9.405829

Test set: Average loss: 9.6356, Accuracy: 1367/10000 (14%)

Train Epoch: 9 [6336/60000 (11%)]	Loss: 9.518722
Train Epoch: 9 [12736/60000 (21%)]	Loss: 10.630446
Train Epoch: 9 [19136/60000 (32%)]	Loss: 8.464260
Train Epoch: 9 [25536/60000 (43%)]	Loss: 12.065415
Train Epoch: 9 [31936/60000 (53%)]	Loss: 9.506962
Train Epoch: 9 [38336/60000 (64%)]	Loss: 10.585497
Train Epoch: 9 [44736/60000 (75%)]	Loss: 9.134350
Train Epoch: 9 [51136/60000 (85%)]	Loss: 8.384570
Train Epoch: 9 [57536/60000 (96%)]	Loss: 8.975875

Test set: Average loss: 9.8614, Accuracy: 1427/10000 (14%)

Train Epoch: 10 [6336/60000 (11%)]	Loss: 9.501442
Train Epoch: 10 [12736/60000 (21%)]	Loss: 9.298313
Train Epoch: 10 [19136/60000 (32%)]	Loss: 9.789897
Train Epoch: 10 [25536/60000 (43%)]	Loss: 10.478558
Train Epoch: 10 [31936/60000 (53%)]	Loss: 10.711121
Train Epoch: 10 [38336/60000 (64%)]	Loss: 10.927722
Train Epoch: 10 [44736/60000 (75%)]	Loss: 7.881824
Train Epoch: 10 [51136/60000 (85%)]	Loss: 9.764774
Train Epoch: 10 [57536/60000 (96%)]	Loss: 8.742887

Test set: Average loss: 10.2838, Accuracy: 1473/10000 (15%)

Train Epoch: 11 [6336/60000 (11%)]	Loss: 11.242968
Train Epoch: 11 [12736/60000 (21%)]	Loss: 9.877369
Train Epoch: 11 [19136/60000 (32%)]	Loss: 8.480567
Train Epoch: 11 [25536/60000 (43%)]	Loss: 8.076303
Train Epoch: 11 [31936/60000 (53%)]	Loss: 11.203037
Train Epoch: 11 [38336/60000 (64%)]	Loss: 9.760061
Train Epoch: 11 [44736/60000 (75%)]	Loss: 10.898556
Train Epoch: 11 [51136/60000 (85%)]	Loss: 8.703774
Train Epoch: 11 [57536/60000 (96%)]	Loss: 9.675636

Test set: Average loss: 10.2753, Accuracy: 1308/10000 (13%)

Train Epoch: 12 [6336/60000 (11%)]	Loss: 10.563492
Train Epoch: 12 [12736/60000 (21%)]	Loss: 8.492193
Train Epoch: 12 [19136/60000 (32%)]	Loss: 9.823158
Train Epoch: 12 [25536/60000 (43%)]	Loss: 7.995064
Train Epoch: 12 [31936/60000 (53%)]	Loss: 8.471789
Train Epoch: 12 [38336/60000 (64%)]	Loss: 9.293215
Train Epoch: 12 [44736/60000 (75%)]	Loss: 7.476530
Train Epoch: 12 [51136/60000 (85%)]	Loss: 9.560961
Train Epoch: 12 [57536/60000 (96%)]	Loss: 12.507781

Test set: Average loss: 10.7394, Accuracy: 1487/10000 (15%)

Train Epoch: 13 [6336/60000 (11%)]	Loss: 11.485037
Train Epoch: 13 [12736/60000 (21%)]	Loss: 11.134506
Train Epoch: 13 [19136/60000 (32%)]	Loss: 8.851927
Train Epoch: 13 [25536/60000 (43%)]	Loss: 11.690471
Train Epoch: 13 [31936/60000 (53%)]	Loss: 9.469065
Train Epoch: 13 [38336/60000 (64%)]	Loss: 8.312038
Train Epoch: 13 [44736/60000 (75%)]	Loss: 10.184456
Train Epoch: 13 [51136/60000 (85%)]	Loss: 9.686019
Train Epoch: 13 [57536/60000 (96%)]	Loss: 9.355568

Test set: Average loss: 10.7354, Accuracy: 1186/10000 (12%)

Train Epoch: 14 [6336/60000 (11%)]	Loss: 10.375259
Train Epoch: 14 [12736/60000 (21%)]	Loss: 9.953725
Train Epoch: 14 [19136/60000 (32%)]	Loss: 11.831898
Train Epoch: 14 [25536/60000 (43%)]	Loss: 10.937754
Train Epoch: 14 [31936/60000 (53%)]	Loss: 10.542912
Train Epoch: 14 [38336/60000 (64%)]	Loss: 10.280691
Train Epoch: 14 [44736/60000 (75%)]	Loss: 10.049760
Train Epoch: 14 [51136/60000 (85%)]	Loss: 9.974025
Train Epoch: 14 [57536/60000 (96%)]	Loss: 10.927143

Test set: Average loss: 10.8432, Accuracy: 1312/10000 (13%)

Train Epoch: 15 [6336/60000 (11%)]	Loss: 10.383089
Train Epoch: 15 [12736/60000 (21%)]	Loss: 11.968544
Train Epoch: 15 [19136/60000 (32%)]	Loss: 10.932301
Train Epoch: 15 [25536/60000 (43%)]	Loss: 12.870348
Train Epoch: 15 [31936/60000 (53%)]	Loss: 9.360170
Train Epoch: 15 [38336/60000 (64%)]	Loss: 9.867395
Train Epoch: 15 [44736/60000 (75%)]	Loss: 11.143577
Train Epoch: 15 [51136/60000 (85%)]	Loss: 9.565004
Train Epoch: 15 [57536/60000 (96%)]	Loss: 10.147856

Test set: Average loss: 10.8687, Accuracy: 1280/10000 (13%)

Train Epoch: 16 [6336/60000 (11%)]	Loss: 11.596513
Train Epoch: 16 [12736/60000 (21%)]	Loss: 10.479486
Train Epoch: 16 [19136/60000 (32%)]	Loss: 11.933812
Train Epoch: 16 [25536/60000 (43%)]	Loss: 9.943454
Train Epoch: 16 [31936/60000 (53%)]	Loss: 11.193883
Train Epoch: 16 [38336/60000 (64%)]	Loss: 10.350012
Train Epoch: 16 [44736/60000 (75%)]	Loss: 9.396016
Train Epoch: 16 [51136/60000 (85%)]	Loss: 11.393542
Train Epoch: 16 [57536/60000 (96%)]	Loss: 9.491585

Test set: Average loss: 10.7197, Accuracy: 1472/10000 (15%)

Train Epoch: 17 [6336/60000 (11%)]	Loss: 10.365067
Train Epoch: 17 [12736/60000 (21%)]	Loss: 11.437836
Train Epoch: 17 [19136/60000 (32%)]	Loss: 9.580263
Train Epoch: 17 [25536/60000 (43%)]	Loss: 8.673840
Train Epoch: 17 [31936/60000 (53%)]	Loss: 8.522699
Train Epoch: 17 [38336/60000 (64%)]	Loss: 10.646415
Train Epoch: 17 [44736/60000 (75%)]	Loss: 12.111750
Train Epoch: 17 [51136/60000 (85%)]	Loss: 10.668186
Train Epoch: 17 [57536/60000 (96%)]	Loss: 9.926452

Test set: Average loss: 10.4485, Accuracy: 1503/10000 (15%)

Train Epoch: 18 [6336/60000 (11%)]	Loss: 10.195251
Train Epoch: 18 [12736/60000 (21%)]	Loss: 11.498033
Train Epoch: 18 [19136/60000 (32%)]	Loss: 9.769480
Train Epoch: 18 [25536/60000 (43%)]	Loss: 10.520080
Train Epoch: 18 [31936/60000 (53%)]	Loss: 10.250575
Train Epoch: 18 [38336/60000 (64%)]	Loss: 8.440187
Train Epoch: 18 [44736/60000 (75%)]	Loss: 10.674076
Train Epoch: 18 [51136/60000 (85%)]	Loss: 10.406708
Train Epoch: 18 [57536/60000 (96%)]	Loss: 8.214037

Test set: Average loss: 10.6995, Accuracy: 1295/10000 (13%)

Train Epoch: 19 [6336/60000 (11%)]	Loss: 11.423368
Train Epoch: 19 [12736/60000 (21%)]	Loss: 9.695621
Train Epoch: 19 [19136/60000 (32%)]	Loss: 10.522128
Train Epoch: 19 [25536/60000 (43%)]	Loss: 10.068939
Train Epoch: 19 [31936/60000 (53%)]	Loss: 9.165676
Train Epoch: 19 [38336/60000 (64%)]	Loss: 9.833207
Train Epoch: 19 [44736/60000 (75%)]	Loss: 10.805717
Train Epoch: 19 [51136/60000 (85%)]	Loss: 8.958751
Train Epoch: 19 [57536/60000 (96%)]	Loss: 9.440235

Test set: Average loss: 10.4390, Accuracy: 1370/10000 (14%)

Train Epoch: 20 [6336/60000 (11%)]	Loss: 10.272791
Train Epoch: 20 [12736/60000 (21%)]	Loss: 10.498075
Train Epoch: 20 [19136/60000 (32%)]	Loss: 11.950107
Train Epoch: 20 [25536/60000 (43%)]	Loss: 8.020761
Train Epoch: 20 [31936/60000 (53%)]	Loss: 10.320717
Train Epoch: 20 [38336/60000 (64%)]	Loss: 11.044048
Train Epoch: 20 [44736/60000 (75%)]	Loss: 10.640273
Train Epoch: 20 [51136/60000 (85%)]	Loss: 10.809505
Train Epoch: 20 [57536/60000 (96%)]	Loss: 11.071361

Test set: Average loss: 11.0059, Accuracy: 1225/10000 (12%)

Namespace(batch_size=64, bias=None, data='../data', device=0, epochs=20, hidden_size=500, load_weights='./paper/lenet5/lenet5_e50_h500.pt', log_interval=100, lr=0.01, model='redlenet5', momentum=0.9, no_cuda=False, r=5, save_model=None, save_results=True, seed=1, sparsity=0.02, use_relu=False, wd=0.0005)


Total time spent pruning/training: 2.19 minutes
Total number of parameters in model: 300170
Number of parameters in pruned model: 294218
