Namespace(batch_size=64, bias=None, data='../data', device=0, epochs=20, hidden_size=500, load_weights='./paper/lenet5/lenet5_e50_h500.pt', log_interval=100, lr=0.01, model='redlenet5', momentum=0.9, no_cuda=False, r=5, save_model=None, save_results=True, seed=1, sparsity=0.75, use_relu=False, wd=0.0005) 

Training a RedLeNet5 network ...
Train Epoch: 1 [6336/60000 (11%)]	Loss: 1.936540
Train Epoch: 1 [12736/60000 (21%)]	Loss: 1.777198
Train Epoch: 1 [19136/60000 (32%)]	Loss: 1.321549
Train Epoch: 1 [25536/60000 (43%)]	Loss: 1.108186
Train Epoch: 1 [31936/60000 (53%)]	Loss: 1.060496
Train Epoch: 1 [38336/60000 (64%)]	Loss: 0.942801
Train Epoch: 1 [44736/60000 (75%)]	Loss: 0.897477
Train Epoch: 1 [51136/60000 (85%)]	Loss: 0.758695
Train Epoch: 1 [57536/60000 (96%)]	Loss: 0.794110

Test set: Average loss: 0.7087, Accuracy: 8011/10000 (80%)

Train Epoch: 2 [6336/60000 (11%)]	Loss: 0.803560
Train Epoch: 2 [12736/60000 (21%)]	Loss: 0.447514
Train Epoch: 2 [19136/60000 (32%)]	Loss: 0.558769
Train Epoch: 2 [25536/60000 (43%)]	Loss: 0.601963
Train Epoch: 2 [31936/60000 (53%)]	Loss: 0.755682
Train Epoch: 2 [38336/60000 (64%)]	Loss: 0.711780
Train Epoch: 2 [44736/60000 (75%)]	Loss: 0.380787
Train Epoch: 2 [51136/60000 (85%)]	Loss: 0.406853
Train Epoch: 2 [57536/60000 (96%)]	Loss: 0.414150

Test set: Average loss: 0.4460, Accuracy: 8646/10000 (86%)

Train Epoch: 3 [6336/60000 (11%)]	Loss: 0.476636
Train Epoch: 3 [12736/60000 (21%)]	Loss: 0.452592
Train Epoch: 3 [19136/60000 (32%)]	Loss: 0.417694
Train Epoch: 3 [25536/60000 (43%)]	Loss: 0.310114
Train Epoch: 3 [31936/60000 (53%)]	Loss: 0.497545
Train Epoch: 3 [38336/60000 (64%)]	Loss: 0.344431
Train Epoch: 3 [44736/60000 (75%)]	Loss: 0.312145
Train Epoch: 3 [51136/60000 (85%)]	Loss: 0.356365
Train Epoch: 3 [57536/60000 (96%)]	Loss: 0.349552

Test set: Average loss: 0.3762, Accuracy: 8838/10000 (88%)

Train Epoch: 4 [6336/60000 (11%)]	Loss: 0.470413
Train Epoch: 4 [12736/60000 (21%)]	Loss: 0.332535
Train Epoch: 4 [19136/60000 (32%)]	Loss: 0.492292
Train Epoch: 4 [25536/60000 (43%)]	Loss: 0.442338
Train Epoch: 4 [31936/60000 (53%)]	Loss: 0.395000
Train Epoch: 4 [38336/60000 (64%)]	Loss: 0.326386
Train Epoch: 4 [44736/60000 (75%)]	Loss: 0.285140
Train Epoch: 4 [51136/60000 (85%)]	Loss: 0.273831
Train Epoch: 4 [57536/60000 (96%)]	Loss: 0.393529

Test set: Average loss: 0.3019, Accuracy: 9133/10000 (91%)

Train Epoch: 5 [6336/60000 (11%)]	Loss: 0.190471
Train Epoch: 5 [12736/60000 (21%)]	Loss: 0.352441
Train Epoch: 5 [19136/60000 (32%)]	Loss: 0.189521
Train Epoch: 5 [25536/60000 (43%)]	Loss: 0.362274
Train Epoch: 5 [31936/60000 (53%)]	Loss: 0.435598
Train Epoch: 5 [38336/60000 (64%)]	Loss: 0.169179
Train Epoch: 5 [44736/60000 (75%)]	Loss: 0.335669
Train Epoch: 5 [51136/60000 (85%)]	Loss: 0.172996
Train Epoch: 5 [57536/60000 (96%)]	Loss: 0.247248

Test set: Average loss: 0.2668, Accuracy: 9220/10000 (92%)

Train Epoch: 6 [6336/60000 (11%)]	Loss: 0.299232
Train Epoch: 6 [12736/60000 (21%)]	Loss: 0.267689
Train Epoch: 6 [19136/60000 (32%)]	Loss: 0.264637
Train Epoch: 6 [25536/60000 (43%)]	Loss: 0.258120
Train Epoch: 6 [31936/60000 (53%)]	Loss: 0.274949
Train Epoch: 6 [38336/60000 (64%)]	Loss: 0.355140
Train Epoch: 6 [44736/60000 (75%)]	Loss: 0.197251
Train Epoch: 6 [51136/60000 (85%)]	Loss: 0.281398
Train Epoch: 6 [57536/60000 (96%)]	Loss: 0.354708

Test set: Average loss: 0.2404, Accuracy: 9315/10000 (93%)

Train Epoch: 7 [6336/60000 (11%)]	Loss: 0.356952
Train Epoch: 7 [12736/60000 (21%)]	Loss: 0.255004
Train Epoch: 7 [19136/60000 (32%)]	Loss: 0.371192
Train Epoch: 7 [25536/60000 (43%)]	Loss: 0.221453
Train Epoch: 7 [31936/60000 (53%)]	Loss: 0.341083
Train Epoch: 7 [38336/60000 (64%)]	Loss: 0.106347
Train Epoch: 7 [44736/60000 (75%)]	Loss: 0.293317
Train Epoch: 7 [51136/60000 (85%)]	Loss: 0.273226
Train Epoch: 7 [57536/60000 (96%)]	Loss: 0.302407

Test set: Average loss: 0.2549, Accuracy: 9221/10000 (92%)

Train Epoch: 8 [6336/60000 (11%)]	Loss: 0.173772
Train Epoch: 8 [12736/60000 (21%)]	Loss: 0.349153
Train Epoch: 8 [19136/60000 (32%)]	Loss: 0.370768
Train Epoch: 8 [25536/60000 (43%)]	Loss: 0.262968
Train Epoch: 8 [31936/60000 (53%)]	Loss: 0.171764
Train Epoch: 8 [38336/60000 (64%)]	Loss: 0.348534
Train Epoch: 8 [44736/60000 (75%)]	Loss: 0.135588
Train Epoch: 8 [51136/60000 (85%)]	Loss: 0.240446
Train Epoch: 8 [57536/60000 (96%)]	Loss: 0.266485

Test set: Average loss: 0.2764, Accuracy: 9170/10000 (92%)

Train Epoch: 9 [6336/60000 (11%)]	Loss: 0.203361
Train Epoch: 9 [12736/60000 (21%)]	Loss: 0.213994
Train Epoch: 9 [19136/60000 (32%)]	Loss: 0.206056
Train Epoch: 9 [25536/60000 (43%)]	Loss: 0.177014
Train Epoch: 9 [31936/60000 (53%)]	Loss: 0.094097
Train Epoch: 9 [38336/60000 (64%)]	Loss: 0.100083
Train Epoch: 9 [44736/60000 (75%)]	Loss: 0.436538
Train Epoch: 9 [51136/60000 (85%)]	Loss: 0.417640
Train Epoch: 9 [57536/60000 (96%)]	Loss: 0.162397

Test set: Average loss: 0.2351, Accuracy: 9295/10000 (93%)

Train Epoch: 10 [6336/60000 (11%)]	Loss: 0.078452
Train Epoch: 10 [12736/60000 (21%)]	Loss: 0.287522
Train Epoch: 10 [19136/60000 (32%)]	Loss: 0.203074
Train Epoch: 10 [25536/60000 (43%)]	Loss: 0.297622
Train Epoch: 10 [31936/60000 (53%)]	Loss: 0.307073
Train Epoch: 10 [38336/60000 (64%)]	Loss: 0.264942
Train Epoch: 10 [44736/60000 (75%)]	Loss: 0.202235
Train Epoch: 10 [51136/60000 (85%)]	Loss: 0.134092
Train Epoch: 10 [57536/60000 (96%)]	Loss: 0.179206

Test set: Average loss: 0.2261, Accuracy: 9339/10000 (93%)

Train Epoch: 11 [6336/60000 (11%)]	Loss: 0.098157
Train Epoch: 11 [12736/60000 (21%)]	Loss: 0.142555
Train Epoch: 11 [19136/60000 (32%)]	Loss: 0.297399
Train Epoch: 11 [25536/60000 (43%)]	Loss: 0.175278
Train Epoch: 11 [31936/60000 (53%)]	Loss: 0.189804
Train Epoch: 11 [38336/60000 (64%)]	Loss: 0.196909
Train Epoch: 11 [44736/60000 (75%)]	Loss: 0.195908
Train Epoch: 11 [51136/60000 (85%)]	Loss: 0.163243
Train Epoch: 11 [57536/60000 (96%)]	Loss: 0.253916

Test set: Average loss: 0.2120, Accuracy: 9370/10000 (94%)

Train Epoch: 12 [6336/60000 (11%)]	Loss: 0.188069
Train Epoch: 12 [12736/60000 (21%)]	Loss: 0.227650
Train Epoch: 12 [19136/60000 (32%)]	Loss: 0.315746
Train Epoch: 12 [25536/60000 (43%)]	Loss: 0.202688
Train Epoch: 12 [31936/60000 (53%)]	Loss: 0.196732
Train Epoch: 12 [38336/60000 (64%)]	Loss: 0.198514
Train Epoch: 12 [44736/60000 (75%)]	Loss: 0.342131
Train Epoch: 12 [51136/60000 (85%)]	Loss: 0.134992
Train Epoch: 12 [57536/60000 (96%)]	Loss: 0.262537

Test set: Average loss: 0.2008, Accuracy: 9412/10000 (94%)

Train Epoch: 13 [6336/60000 (11%)]	Loss: 0.237189
Train Epoch: 13 [12736/60000 (21%)]	Loss: 0.185175
Train Epoch: 13 [19136/60000 (32%)]	Loss: 0.157938
Train Epoch: 13 [25536/60000 (43%)]	Loss: 0.161317
Train Epoch: 13 [31936/60000 (53%)]	Loss: 0.403497
Train Epoch: 13 [38336/60000 (64%)]	Loss: 0.098720
Train Epoch: 13 [44736/60000 (75%)]	Loss: 0.339309
Train Epoch: 13 [51136/60000 (85%)]	Loss: 0.286335
Train Epoch: 13 [57536/60000 (96%)]	Loss: 0.210567

Test set: Average loss: 0.2311, Accuracy: 9349/10000 (93%)

Train Epoch: 14 [6336/60000 (11%)]	Loss: 0.144118
Train Epoch: 14 [12736/60000 (21%)]	Loss: 0.073092
Train Epoch: 14 [19136/60000 (32%)]	Loss: 0.324710
Train Epoch: 14 [25536/60000 (43%)]	Loss: 0.195181
Train Epoch: 14 [31936/60000 (53%)]	Loss: 0.226071
Train Epoch: 14 [38336/60000 (64%)]	Loss: 0.211129
Train Epoch: 14 [44736/60000 (75%)]	Loss: 0.102437
Train Epoch: 14 [51136/60000 (85%)]	Loss: 0.163775
Train Epoch: 14 [57536/60000 (96%)]	Loss: 0.291124

Test set: Average loss: 0.2124, Accuracy: 9375/10000 (94%)

Train Epoch: 15 [6336/60000 (11%)]	Loss: 0.188313
Train Epoch: 15 [12736/60000 (21%)]	Loss: 0.141923
Train Epoch: 15 [19136/60000 (32%)]	Loss: 0.245978
Train Epoch: 15 [25536/60000 (43%)]	Loss: 0.261451
Train Epoch: 15 [31936/60000 (53%)]	Loss: 0.188755
Train Epoch: 15 [38336/60000 (64%)]	Loss: 0.268136
Train Epoch: 15 [44736/60000 (75%)]	Loss: 0.243412
Train Epoch: 15 [51136/60000 (85%)]	Loss: 0.193325
Train Epoch: 15 [57536/60000 (96%)]	Loss: 0.100683

Test set: Average loss: 0.2034, Accuracy: 9415/10000 (94%)

Train Epoch: 16 [6336/60000 (11%)]	Loss: 0.309429
Train Epoch: 16 [12736/60000 (21%)]	Loss: 0.233689
Train Epoch: 16 [19136/60000 (32%)]	Loss: 0.163037
Train Epoch: 16 [25536/60000 (43%)]	Loss: 0.152564
Train Epoch: 16 [31936/60000 (53%)]	Loss: 0.197092
Train Epoch: 16 [38336/60000 (64%)]	Loss: 0.217405
Train Epoch: 16 [44736/60000 (75%)]	Loss: 0.124955
Train Epoch: 16 [51136/60000 (85%)]	Loss: 0.275631
Train Epoch: 16 [57536/60000 (96%)]	Loss: 0.156521

Test set: Average loss: 0.2159, Accuracy: 9358/10000 (94%)

Train Epoch: 17 [6336/60000 (11%)]	Loss: 0.378345
Train Epoch: 17 [12736/60000 (21%)]	Loss: 0.334723
Train Epoch: 17 [19136/60000 (32%)]	Loss: 0.127116
Train Epoch: 17 [25536/60000 (43%)]	Loss: 0.120318
Train Epoch: 17 [31936/60000 (53%)]	Loss: 0.180527
Train Epoch: 17 [38336/60000 (64%)]	Loss: 0.130460
Train Epoch: 17 [44736/60000 (75%)]	Loss: 0.304987
Train Epoch: 17 [51136/60000 (85%)]	Loss: 0.104011
Train Epoch: 17 [57536/60000 (96%)]	Loss: 0.283034

Test set: Average loss: 0.1986, Accuracy: 9420/10000 (94%)

Train Epoch: 18 [6336/60000 (11%)]	Loss: 0.133748
Train Epoch: 18 [12736/60000 (21%)]	Loss: 0.182035
Train Epoch: 18 [19136/60000 (32%)]	Loss: 0.142583
Train Epoch: 18 [25536/60000 (43%)]	Loss: 0.102303
Train Epoch: 18 [31936/60000 (53%)]	Loss: 0.152621
Train Epoch: 18 [38336/60000 (64%)]	Loss: 0.202447
Train Epoch: 18 [44736/60000 (75%)]	Loss: 0.223061
Train Epoch: 18 [51136/60000 (85%)]	Loss: 0.130104
Train Epoch: 18 [57536/60000 (96%)]	Loss: 0.259058

Test set: Average loss: 0.1885, Accuracy: 9451/10000 (95%)

Train Epoch: 19 [6336/60000 (11%)]	Loss: 0.188002
Train Epoch: 19 [12736/60000 (21%)]	Loss: 0.184931
Train Epoch: 19 [19136/60000 (32%)]	Loss: 0.127498
Train Epoch: 19 [25536/60000 (43%)]	Loss: 0.230114
Train Epoch: 19 [31936/60000 (53%)]	Loss: 0.212485
Train Epoch: 19 [38336/60000 (64%)]	Loss: 0.147081
Train Epoch: 19 [44736/60000 (75%)]	Loss: 0.179309
Train Epoch: 19 [51136/60000 (85%)]	Loss: 0.111096
Train Epoch: 19 [57536/60000 (96%)]	Loss: 0.252934

Test set: Average loss: 0.1940, Accuracy: 9411/10000 (94%)

Train Epoch: 20 [6336/60000 (11%)]	Loss: 0.079315
Train Epoch: 20 [12736/60000 (21%)]	Loss: 0.143992
Train Epoch: 20 [19136/60000 (32%)]	Loss: 0.185498
Train Epoch: 20 [25536/60000 (43%)]	Loss: 0.422065
Train Epoch: 20 [31936/60000 (53%)]	Loss: 0.169332
Train Epoch: 20 [38336/60000 (64%)]	Loss: 0.169520
Train Epoch: 20 [44736/60000 (75%)]	Loss: 0.326483
Train Epoch: 20 [51136/60000 (85%)]	Loss: 0.291788
Train Epoch: 20 [57536/60000 (96%)]	Loss: 0.223879

Test set: Average loss: 0.2160, Accuracy: 9337/10000 (93%)

Namespace(batch_size=64, bias=None, data='../data', device=0, epochs=20, hidden_size=500, load_weights='./paper/lenet5/lenet5_e50_h500.pt', log_interval=100, lr=0.01, model='redlenet5', momentum=0.9, no_cuda=False, r=5, save_model=None, save_results=True, seed=1, sparsity=0.75, use_relu=False, wd=0.0005)


Total time spent pruning/training: 2.22 minutes
Total number of parameters in model: 300170
Number of parameters in pruned model: 76955
