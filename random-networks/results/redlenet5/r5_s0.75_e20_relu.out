Namespace(batch_size=64, bias=None, data='../data', device=0, epochs=20, hidden_size=500, load_weights='./paper/lenet5/lenet5_e50_h500.pt', log_interval=100, lr=0.01, model='redlenet5', momentum=0.9, no_cuda=False, r=5, save_model=None, save_results=True, seed=1, sparsity=0.75, use_relu=True, wd=0.0005) 

Training a RedLeNet5 network ...
Train Epoch: 1 [6336/60000 (11%)]	Loss: 2.271229
Train Epoch: 1 [12736/60000 (21%)]	Loss: 2.265860
Train Epoch: 1 [19136/60000 (32%)]	Loss: 2.209345
Train Epoch: 1 [25536/60000 (43%)]	Loss: 2.018531
Train Epoch: 1 [31936/60000 (53%)]	Loss: 2.022893
Train Epoch: 1 [38336/60000 (64%)]	Loss: 2.026596
Train Epoch: 1 [44736/60000 (75%)]	Loss: 1.932613
Train Epoch: 1 [51136/60000 (85%)]	Loss: 1.849635
Train Epoch: 1 [57536/60000 (96%)]	Loss: 1.666542

Test set: Average loss: 1.7784, Accuracy: 4378/10000 (44%)

Train Epoch: 2 [6336/60000 (11%)]	Loss: 1.772088
Train Epoch: 2 [12736/60000 (21%)]	Loss: 1.679173
Train Epoch: 2 [19136/60000 (32%)]	Loss: 1.617449
Train Epoch: 2 [25536/60000 (43%)]	Loss: 1.699836
Train Epoch: 2 [31936/60000 (53%)]	Loss: 1.708563
Train Epoch: 2 [38336/60000 (64%)]	Loss: 1.779848
Train Epoch: 2 [44736/60000 (75%)]	Loss: 1.526798
Train Epoch: 2 [51136/60000 (85%)]	Loss: 1.683903
Train Epoch: 2 [57536/60000 (96%)]	Loss: 1.742090

Test set: Average loss: 1.6160, Accuracy: 5199/10000 (52%)

Train Epoch: 3 [6336/60000 (11%)]	Loss: 1.682500
Train Epoch: 3 [12736/60000 (21%)]	Loss: 1.595807
Train Epoch: 3 [19136/60000 (32%)]	Loss: 1.512053
Train Epoch: 3 [25536/60000 (43%)]	Loss: 1.535854
Train Epoch: 3 [31936/60000 (53%)]	Loss: 1.608350
Train Epoch: 3 [38336/60000 (64%)]	Loss: 1.576999
Train Epoch: 3 [44736/60000 (75%)]	Loss: 1.524856
Train Epoch: 3 [51136/60000 (85%)]	Loss: 1.657515
Train Epoch: 3 [57536/60000 (96%)]	Loss: 1.557710

Test set: Average loss: 1.5214, Accuracy: 5886/10000 (59%)

Train Epoch: 4 [6336/60000 (11%)]	Loss: 1.653036
Train Epoch: 4 [12736/60000 (21%)]	Loss: 1.622755
Train Epoch: 4 [19136/60000 (32%)]	Loss: 1.487519
Train Epoch: 4 [25536/60000 (43%)]	Loss: 1.554288
Train Epoch: 4 [31936/60000 (53%)]	Loss: 1.507262
Train Epoch: 4 [38336/60000 (64%)]	Loss: 1.524783
Train Epoch: 4 [44736/60000 (75%)]	Loss: 1.423149
Train Epoch: 4 [51136/60000 (85%)]	Loss: 1.541929
Train Epoch: 4 [57536/60000 (96%)]	Loss: 1.657833

Test set: Average loss: 1.4784, Accuracy: 6008/10000 (60%)

Train Epoch: 5 [6336/60000 (11%)]	Loss: 1.484684
Train Epoch: 5 [12736/60000 (21%)]	Loss: 1.466163
Train Epoch: 5 [19136/60000 (32%)]	Loss: 1.478326
Train Epoch: 5 [25536/60000 (43%)]	Loss: 1.447496
Train Epoch: 5 [31936/60000 (53%)]	Loss: 1.686006
Train Epoch: 5 [38336/60000 (64%)]	Loss: 1.376729
Train Epoch: 5 [44736/60000 (75%)]	Loss: 1.449104
Train Epoch: 5 [51136/60000 (85%)]	Loss: 1.446468
Train Epoch: 5 [57536/60000 (96%)]	Loss: 1.581681

Test set: Average loss: 1.4916, Accuracy: 5698/10000 (57%)

Train Epoch: 6 [6336/60000 (11%)]	Loss: 1.453594
Train Epoch: 6 [12736/60000 (21%)]	Loss: 1.410583
Train Epoch: 6 [19136/60000 (32%)]	Loss: 1.422987
Train Epoch: 6 [25536/60000 (43%)]	Loss: 1.405385
Train Epoch: 6 [31936/60000 (53%)]	Loss: 1.578882
Train Epoch: 6 [38336/60000 (64%)]	Loss: 1.512431
Train Epoch: 6 [44736/60000 (75%)]	Loss: 1.426310
Train Epoch: 6 [51136/60000 (85%)]	Loss: 1.455044
Train Epoch: 6 [57536/60000 (96%)]	Loss: 1.464323

Test set: Average loss: 1.4176, Accuracy: 6132/10000 (61%)

Train Epoch: 7 [6336/60000 (11%)]	Loss: 1.375491
Train Epoch: 7 [12736/60000 (21%)]	Loss: 1.498877
Train Epoch: 7 [19136/60000 (32%)]	Loss: 1.483959
Train Epoch: 7 [25536/60000 (43%)]	Loss: 1.264741
Train Epoch: 7 [31936/60000 (53%)]	Loss: 1.488438
Train Epoch: 7 [38336/60000 (64%)]	Loss: 1.408811
Train Epoch: 7 [44736/60000 (75%)]	Loss: 1.569770
Train Epoch: 7 [51136/60000 (85%)]	Loss: 1.462933
Train Epoch: 7 [57536/60000 (96%)]	Loss: 1.437781

Test set: Average loss: 1.3686, Accuracy: 6465/10000 (65%)

Train Epoch: 8 [6336/60000 (11%)]	Loss: 1.263078
Train Epoch: 8 [12736/60000 (21%)]	Loss: 1.350731
Train Epoch: 8 [19136/60000 (32%)]	Loss: 1.318520
Train Epoch: 8 [25536/60000 (43%)]	Loss: 1.337194
Train Epoch: 8 [31936/60000 (53%)]	Loss: 1.304232
Train Epoch: 8 [38336/60000 (64%)]	Loss: 1.355270
Train Epoch: 8 [44736/60000 (75%)]	Loss: 1.330233
Train Epoch: 8 [51136/60000 (85%)]	Loss: 1.345150
Train Epoch: 8 [57536/60000 (96%)]	Loss: 1.289620

Test set: Average loss: 1.3722, Accuracy: 6029/10000 (60%)

Train Epoch: 9 [6336/60000 (11%)]	Loss: 1.293129
Train Epoch: 9 [12736/60000 (21%)]	Loss: 1.377447
Train Epoch: 9 [19136/60000 (32%)]	Loss: 1.439287
Train Epoch: 9 [25536/60000 (43%)]	Loss: 1.456079
Train Epoch: 9 [31936/60000 (53%)]	Loss: 1.239233
Train Epoch: 9 [38336/60000 (64%)]	Loss: 1.313748
Train Epoch: 9 [44736/60000 (75%)]	Loss: 1.492621
Train Epoch: 9 [51136/60000 (85%)]	Loss: 1.440033
Train Epoch: 9 [57536/60000 (96%)]	Loss: 1.355274

Test set: Average loss: 1.3218, Accuracy: 6673/10000 (67%)

Train Epoch: 10 [6336/60000 (11%)]	Loss: 1.292953
Train Epoch: 10 [12736/60000 (21%)]	Loss: 1.334652
Train Epoch: 10 [19136/60000 (32%)]	Loss: 1.248221
Train Epoch: 10 [25536/60000 (43%)]	Loss: 1.529506
Train Epoch: 10 [31936/60000 (53%)]	Loss: 1.373939
Train Epoch: 10 [38336/60000 (64%)]	Loss: 1.350506
Train Epoch: 10 [44736/60000 (75%)]	Loss: 1.285031
Train Epoch: 10 [51136/60000 (85%)]	Loss: 1.285416
Train Epoch: 10 [57536/60000 (96%)]	Loss: 1.323860

Test set: Average loss: 1.3343, Accuracy: 6714/10000 (67%)

Train Epoch: 11 [6336/60000 (11%)]	Loss: 1.162959
Train Epoch: 11 [12736/60000 (21%)]	Loss: 1.355148
Train Epoch: 11 [19136/60000 (32%)]	Loss: 1.321102
Train Epoch: 11 [25536/60000 (43%)]	Loss: 1.301878
Train Epoch: 11 [31936/60000 (53%)]	Loss: 1.341947
Train Epoch: 11 [38336/60000 (64%)]	Loss: 1.275740
Train Epoch: 11 [44736/60000 (75%)]	Loss: 1.306805
Train Epoch: 11 [51136/60000 (85%)]	Loss: 1.328169
Train Epoch: 11 [57536/60000 (96%)]	Loss: 1.415434

Test set: Average loss: 1.3017, Accuracy: 6783/10000 (68%)

Train Epoch: 12 [6336/60000 (11%)]	Loss: 1.257838
Train Epoch: 12 [12736/60000 (21%)]	Loss: 1.238998
Train Epoch: 12 [19136/60000 (32%)]	Loss: 1.278119
Train Epoch: 12 [25536/60000 (43%)]	Loss: 1.266066
Train Epoch: 12 [31936/60000 (53%)]	Loss: 1.241798
Train Epoch: 12 [38336/60000 (64%)]	Loss: 1.255313
Train Epoch: 12 [44736/60000 (75%)]	Loss: 1.226177
Train Epoch: 12 [51136/60000 (85%)]	Loss: 1.287076
Train Epoch: 12 [57536/60000 (96%)]	Loss: 1.257076

Test set: Average loss: 1.2957, Accuracy: 6731/10000 (67%)

Train Epoch: 13 [6336/60000 (11%)]	Loss: 1.431177
Train Epoch: 13 [12736/60000 (21%)]	Loss: 1.360762
Train Epoch: 13 [19136/60000 (32%)]	Loss: 1.355580
Train Epoch: 13 [25536/60000 (43%)]	Loss: 1.347378
Train Epoch: 13 [31936/60000 (53%)]	Loss: 1.393285
Train Epoch: 13 [38336/60000 (64%)]	Loss: 1.122902
Train Epoch: 13 [44736/60000 (75%)]	Loss: 1.332454
Train Epoch: 13 [51136/60000 (85%)]	Loss: 1.495708
Train Epoch: 13 [57536/60000 (96%)]	Loss: 1.187640

Test set: Average loss: 1.2875, Accuracy: 6808/10000 (68%)

Train Epoch: 14 [6336/60000 (11%)]	Loss: 1.209933
Train Epoch: 14 [12736/60000 (21%)]	Loss: 1.177726
Train Epoch: 14 [19136/60000 (32%)]	Loss: 1.346472
Train Epoch: 14 [25536/60000 (43%)]	Loss: 1.254391
Train Epoch: 14 [31936/60000 (53%)]	Loss: 1.395310
Train Epoch: 14 [38336/60000 (64%)]	Loss: 1.304353
Train Epoch: 14 [44736/60000 (75%)]	Loss: 1.218576
Train Epoch: 14 [51136/60000 (85%)]	Loss: 1.181357
Train Epoch: 14 [57536/60000 (96%)]	Loss: 1.397824

Test set: Average loss: 1.3649, Accuracy: 5598/10000 (56%)

Train Epoch: 15 [6336/60000 (11%)]	Loss: 1.236642
Train Epoch: 15 [12736/60000 (21%)]	Loss: 1.249540
Train Epoch: 15 [19136/60000 (32%)]	Loss: 1.437404
Train Epoch: 15 [25536/60000 (43%)]	Loss: 1.380238
Train Epoch: 15 [31936/60000 (53%)]	Loss: 1.322885
Train Epoch: 15 [38336/60000 (64%)]	Loss: 1.385091
Train Epoch: 15 [44736/60000 (75%)]	Loss: 1.439465
Train Epoch: 15 [51136/60000 (85%)]	Loss: 1.262975
Train Epoch: 15 [57536/60000 (96%)]	Loss: 1.237655

Test set: Average loss: 1.3310, Accuracy: 6042/10000 (60%)

Train Epoch: 16 [6336/60000 (11%)]	Loss: 1.346297
Train Epoch: 16 [12736/60000 (21%)]	Loss: 1.290604
Train Epoch: 16 [19136/60000 (32%)]	Loss: 1.300640
Train Epoch: 16 [25536/60000 (43%)]	Loss: 1.178405
Train Epoch: 16 [31936/60000 (53%)]	Loss: 1.287075
Train Epoch: 16 [38336/60000 (64%)]	Loss: 1.290782
Train Epoch: 16 [44736/60000 (75%)]	Loss: 1.267267
Train Epoch: 16 [51136/60000 (85%)]	Loss: 1.421818
Train Epoch: 16 [57536/60000 (96%)]	Loss: 1.171674

Test set: Average loss: 1.2810, Accuracy: 6736/10000 (67%)

Train Epoch: 17 [6336/60000 (11%)]	Loss: 1.446215
Train Epoch: 17 [12736/60000 (21%)]	Loss: 1.274286
Train Epoch: 17 [19136/60000 (32%)]	Loss: 1.337016
Train Epoch: 17 [25536/60000 (43%)]	Loss: 1.134216
Train Epoch: 17 [31936/60000 (53%)]	Loss: 1.226850
Train Epoch: 17 [38336/60000 (64%)]	Loss: 1.224953
Train Epoch: 17 [44736/60000 (75%)]	Loss: 1.297241
Train Epoch: 17 [51136/60000 (85%)]	Loss: 1.202185
Train Epoch: 17 [57536/60000 (96%)]	Loss: 1.438722

Test set: Average loss: 1.2747, Accuracy: 7005/10000 (70%)

Train Epoch: 18 [6336/60000 (11%)]	Loss: 1.246113
Train Epoch: 18 [12736/60000 (21%)]	Loss: 1.339265
Train Epoch: 18 [19136/60000 (32%)]	Loss: 1.230591
Train Epoch: 18 [25536/60000 (43%)]	Loss: 1.332630
Train Epoch: 18 [31936/60000 (53%)]	Loss: 1.300891
Train Epoch: 18 [38336/60000 (64%)]	Loss: 1.191168
Train Epoch: 18 [44736/60000 (75%)]	Loss: 1.368151
Train Epoch: 18 [51136/60000 (85%)]	Loss: 1.305137
Train Epoch: 18 [57536/60000 (96%)]	Loss: 1.291488

Test set: Average loss: 1.2811, Accuracy: 6685/10000 (67%)

Train Epoch: 19 [6336/60000 (11%)]	Loss: 1.216570
Train Epoch: 19 [12736/60000 (21%)]	Loss: 1.357142
Train Epoch: 19 [19136/60000 (32%)]	Loss: 1.285040
Train Epoch: 19 [25536/60000 (43%)]	Loss: 1.240779
Train Epoch: 19 [31936/60000 (53%)]	Loss: 1.439440
Train Epoch: 19 [38336/60000 (64%)]	Loss: 1.309651
Train Epoch: 19 [44736/60000 (75%)]	Loss: 1.274121
Train Epoch: 19 [51136/60000 (85%)]	Loss: 1.141546
Train Epoch: 19 [57536/60000 (96%)]	Loss: 1.317387

Test set: Average loss: 1.2738, Accuracy: 6965/10000 (70%)

Train Epoch: 20 [6336/60000 (11%)]	Loss: 1.331299
Train Epoch: 20 [12736/60000 (21%)]	Loss: 1.238679
Train Epoch: 20 [19136/60000 (32%)]	Loss: 1.357595
Train Epoch: 20 [25536/60000 (43%)]	Loss: 1.496804
Train Epoch: 20 [31936/60000 (53%)]	Loss: 1.296665
Train Epoch: 20 [38336/60000 (64%)]	Loss: 1.213124
Train Epoch: 20 [44736/60000 (75%)]	Loss: 1.313819
Train Epoch: 20 [51136/60000 (85%)]	Loss: 1.319132
Train Epoch: 20 [57536/60000 (96%)]	Loss: 1.326139

Test set: Average loss: 1.3606, Accuracy: 5621/10000 (56%)

Namespace(batch_size=64, bias=None, data='../data', device=0, epochs=20, hidden_size=500, load_weights='./paper/lenet5/lenet5_e50_h500.pt', log_interval=100, lr=0.01, model='redlenet5', momentum=0.9, no_cuda=False, r=5, save_model=None, save_results=True, seed=1, sparsity=0.75, use_relu=True, wd=0.0005)


Total time spent pruning/training: 2.19 minutes
Total number of parameters in model: 300170
Number of parameters in pruned model: 76955
